-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS academico.aluno
(
    id_aluno serial NOT NULL,
    nome_completo character varying(100) COLLATE pg_catalog."default",
    email character varying(100) COLLATE pg_catalog."default",
    telefone character varying(20) COLLATE pg_catalog."default",
    data_nascimento date,
    status_ativo boolean,
    data_cadastro timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT aluno_pkey PRIMARY KEY (id_aluno),
    CONSTRAINT aluno_email_key UNIQUE (email)
);

CREATE TABLE IF NOT EXISTS academico.curso
(
    id_curso serial NOT NULL,
    nome character varying(100) COLLATE pg_catalog."default",
    descricao text COLLATE pg_catalog."default",
    carga_horaria smallint,
    preco_padrao numeric(10, 2),
    CONSTRAINT curso_pkey PRIMARY KEY (id_curso)
);

CREATE TABLE IF NOT EXISTS academico.disciplina
(
    id_disciplina serial NOT NULL,
    nome character varying(100) COLLATE pg_catalog."default",
    carga_horaria smallint,
    CONSTRAINT disciplina_pkey PRIMARY KEY (id_disciplina)
);

CREATE TABLE IF NOT EXISTS academico.funcionario
(
    id_funcionario serial NOT NULL,
    nome character varying(100) COLLATE pg_catalog."default",
    cargo character varying(50) COLLATE pg_catalog."default",
    email character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT funcionario_pkey PRIMARY KEY (id_funcionario)
);

CREATE TABLE IF NOT EXISTS academico.inscricao
(
    id_inscricao serial NOT NULL,
    xid_aluno integer,
    xid_turma integer,
    data_inscricao timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT inscricao_pkey PRIMARY KEY (id_inscricao)
);

CREATE TABLE IF NOT EXISTS academico.item_venda
(
    id_item_venda serial NOT NULL,
    xid_venda integer,
    xid_material integer,
    quantidade smallint,
    preco_unitario numeric(10, 2),
    CONSTRAINT item_venda_pkey PRIMARY KEY (id_item_venda)
);

CREATE TABLE IF NOT EXISTS academico.material
(
    id_material serial NOT NULL,
    nome character varying(100) COLLATE pg_catalog."default",
    descricao text COLLATE pg_catalog."default",
    preco_venda numeric(10, 2),
    estoque_atual integer,
    CONSTRAINT material_pkey PRIMARY KEY (id_material)
);

CREATE TABLE IF NOT EXISTS academico.pagamento
(
    id_pagamento serial NOT NULL,
    xid_aluno integer,
    valor numeric(10, 2),
    data_vencimento date,
    data_pagamento date,
    mes_referencia character varying(7) COLLATE pg_catalog."default",
    status status_pagamento,
    CONSTRAINT pagamento_pkey PRIMARY KEY (id_pagamento)
);

CREATE TABLE IF NOT EXISTS academico.professor
(
    id_professor serial NOT NULL,
    nome character varying(100) COLLATE pg_catalog."default",
    email character varying(100) COLLATE pg_catalog."default",
    telefone character varying(20) COLLATE pg_catalog."default",
    especialidade character varying(100) COLLATE pg_catalog."default",
    data_contratacao date,
    CONSTRAINT professor_pkey PRIMARY KEY (id_professor),
    CONSTRAINT professor_email_key UNIQUE (email)
);

CREATE TABLE IF NOT EXISTS academico.professor_disciplina
(
    id_professor integer NOT NULL,
    id_disciplina integer NOT NULL,
    CONSTRAINT professor_disciplina_pkey PRIMARY KEY (id_professor, id_disciplina)
);

CREATE TABLE IF NOT EXISTS academico.tarefa_auxiliar
(
    id_tarefa serial NOT NULL,
    titulo character varying(100) COLLATE pg_catalog."default",
    descricao text COLLATE pg_catalog."default",
    prioridade prioridade_tarefa,
    data_vencimento date,
    status status_tarefa,
    xid_funcionario integer,
    id_funcionario integer,
    CONSTRAINT tarefa_auxiliar_pkey PRIMARY KEY (id_tarefa)
);

CREATE TABLE IF NOT EXISTS academico.tarefa_escolar
(
    id_tarefa_escolar serial NOT NULL,
    xid_aluno integer,
    titulo character varying(100) COLLATE pg_catalog."default",
    descricao text COLLATE pg_catalog."default",
    tipo tipo_tarefa_escolar NOT NULL,
    progresso_curso smallint,
    progresso_leitura smallint,
    texto_oracao text COLLATE pg_catalog."default",
    audio_link text COLLATE pg_catalog."default",
    data_entrega date,
    status status_tarefa_escolar NOT NULL,
    id_professor integer,
    CONSTRAINT tarefa_escolar_pkey PRIMARY KEY (id_tarefa_escolar)
);

CREATE TABLE IF NOT EXISTS academico.turma
(
    id_turma serial NOT NULL,
    nome_turma character varying(100) COLLATE pg_catalog."default",
    ano smallint,
    semestre smallint,
    horario_inicio time without time zone,
    horario_fim time without time zone,
    xid_curso integer,
    id_professor integer,
    CONSTRAINT turma_pkey PRIMARY KEY (id_turma)
);

CREATE TABLE IF NOT EXISTS academico.venda
(
    id_venda serial NOT NULL,
    xid_aluno integer,
    data_venda timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    valor_total numeric(10, 2),
    CONSTRAINT venda_pkey PRIMARY KEY (id_venda)
);

ALTER TABLE IF EXISTS academico.inscricao
    ADD CONSTRAINT inscricao_xid_aluno_fkey FOREIGN KEY (xid_aluno)
    REFERENCES academico.aluno (id_aluno) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.inscricao
    ADD CONSTRAINT inscricao_xid_turma_fkey FOREIGN KEY (xid_turma)
    REFERENCES academico.turma (id_turma) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.item_venda
    ADD CONSTRAINT item_venda_xid_material_fkey FOREIGN KEY (xid_material)
    REFERENCES academico.material (id_material) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.item_venda
    ADD CONSTRAINT item_venda_xid_venda_fkey FOREIGN KEY (xid_venda)
    REFERENCES academico.venda (id_venda) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.pagamento
    ADD CONSTRAINT pagamento_xid_aluno_fkey FOREIGN KEY (xid_aluno)
    REFERENCES academico.aluno (id_aluno) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.professor_disciplina
    ADD CONSTRAINT professor_disciplina_id_disciplina_fkey FOREIGN KEY (id_disciplina)
    REFERENCES academico.disciplina (id_disciplina) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.professor_disciplina
    ADD CONSTRAINT professor_disciplina_id_professor_fkey FOREIGN KEY (id_professor)
    REFERENCES academico.professor (id_professor) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.tarefa_auxiliar
    ADD CONSTRAINT tarefa_auxiliar_id_funcionario_fkey FOREIGN KEY (id_funcionario)
    REFERENCES academico.funcionario (id_funcionario) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.tarefa_escolar
    ADD CONSTRAINT tarefa_escolar_id_professor_fkey FOREIGN KEY (id_professor)
    REFERENCES academico.professor (id_professor) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE SET NULL;


ALTER TABLE IF EXISTS academico.tarefa_escolar
    ADD CONSTRAINT tarefa_escolar_xid_aluno_fkey FOREIGN KEY (xid_aluno)
    REFERENCES academico.aluno (id_aluno) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.turma
    ADD CONSTRAINT turma_id_professor_fkey FOREIGN KEY (id_professor)
    REFERENCES academico.professor (id_professor) MATCH SIMPLE
    ON UPDATE CASCADE
    ON DELETE SET NULL;


ALTER TABLE IF EXISTS academico.turma
    ADD CONSTRAINT turma_xid_curso_fkey FOREIGN KEY (xid_curso)
    REFERENCES academico.curso (id_curso) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS academico.venda
    ADD CONSTRAINT venda_xid_aluno_fkey FOREIGN KEY (xid_aluno)
    REFERENCES academico.aluno (id_aluno) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;